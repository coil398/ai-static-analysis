# improve-skill

既存のスキル定義を改善・更新するためのメタスキル。

---

## 概要

スキル定義（`.claude/skills/*.md`）は、実装が進むにつれて以下の理由で更新が必要になる：
- 実装中に新たな要件や制約が判明
- SPEC.md の変更に追従
- 他のスキルとの整合性維持
- テンプレートや規約の改善

このスキルは、スキル定義のレビュー・更新・整合性チェックを体系的に行う。

## SPEC.md 参照

- セクション: 該当なし（開発プロセスのメタスキル）
- 関連要件: §12 MVP 順序との整合性維持

## 入力

- `skill_name`: 改善対象のスキル名（例: `create-skill`, `index-facts`）
- `reason`: 改善理由（例: 実装中の発見、SPEC.md 変更、他スキルとの矛盾）

## 出力

- 更新された `.claude/skills/<skill_name>.md`
- 変更内容のサマリー（何を・なぜ・どう変更したか）

## 依存

- `create-skill`: スキル定義テンプレートと規約を参照

## 実装

### 配置先

`.claude/skills/improve-skill.md` のみ（メタスキル、実装コード不要）

### 実装言語

なし（指示書のみ）

### 処理フロー

1. **現状分析**
   - 対象スキル定義を読み込む
   - 関連する実装コード（あれば）を確認
   - SPEC.md の該当セクションを確認

2. **改善点の特定**
   - create-skill.md のテンプレートとの差分
   - SPEC.md 整合性チェックリストの再実行
   - 他のスキル定義との一貫性チェック
   - 実装と定義の乖離チェック

3. **更新案の作成**
   - 必要な追加・修正・削除を列挙
   - 影響範囲を分析（他のスキル定義への波及）

4. **適用と検証**
   - スキル定義を更新
   - create-skill.md のチェックリストを再実行
   - 変更サマリーを生成

### エラーハンドリング

- 対象スキルが存在しない場合は終了
- SPEC.md との矛盾を発見した場合は、SPEC.md の更新も提案

## 改善パターン

以下のような改善を体系的に実施する：

### パターン 1: テンプレート準拠

create-skill.md のテンプレート構造（概要、SPEC.md 参照、入出力、依存、実装、使用例）に不足がないか確認し、追加。

### パターン 2: SPEC.md 整合性

SPEC.md 整合性チェックリスト（§2, §3, §4, §5-6, §7, §8, §12, §13）を再実行し、新たな違反や不足を修正。

### パターン 3: 実装との同期

実装コードが進んだ結果、スキル定義の「処理フロー」や「エラーハンドリング」が古くなっている場合に更新。

### パターン 4: 規約の反映

create-skill.md の命名規約やディレクトリ配置規約が更新された場合に、既存スキル定義を追従させる。

### パターン 5: 依存関係の更新

新しいスキルが追加され、依存関係が変化した場合に「依存」セクションを更新。

## チェックリスト

スキル定義を改善する際は、以下をすべて確認する：

- [ ] create-skill.md のテンプレート構造に準拠しているか
- [ ] SPEC.md 整合性チェックリストをパスするか
- [ ] 他のスキル定義と命名・構造が一貫しているか
- [ ] 実装コード（あれば）と定義が一致しているか
- [ ] 依存するスキルが正しく列挙されているか
- [ ] 使用例が最新の仕様を反映しているか

## 使用例

### 例 1: 実装進行に伴う更新

```
improve-skill を実行:
- skill_name: index-facts
- reason: cache/ の実装が完了し、fingerprint 生成の詳細が確定したため

結果:
- 「処理フロー」に fingerprint 生成の具体的なステップを追記
- 「エラーハンドリング」に fingerprint 不一致時の挙動を追記
```

### 例 2: SPEC.md 変更への追従

```
improve-skill を実行:
- skill_name: query-facts
- reason: SPEC.md §10 にクエリ仕様の詳細が追加されたため

結果:
- 「SPEC.md 参照」に §10 を追加
- 「入力」に新しいクエリパラメータを追記
- 整合性チェックリストを更新
```

### 例 3: create-skill.md の規約改善への追従

```
improve-skill を実行:
- skill_name: create-skill
- reason: 「メタメタスキル」パターンが判明し、improve-skill の存在を織り込むべき

結果:
- create-skill.md の「スキル作成プロセス」に Step 6 として「継続的改善」を追加
- improve-skill への言及を追記
```

## 注意事項

- スキル定義の更新は、必ず変更理由とともに記録する
- SPEC.md との矛盾を発見した場合は、どちらを正とするか判断してから更新する
- 複数のスキル定義に影響する変更の場合は、すべて一貫して更新する
- create-skill.md 自体の改善も、このスキルを使って行う（メタメタ適用）
